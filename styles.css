/* CSS Variables for Themes */
:root {
    /* UI Fonts */
    --font-ui: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    --font-mono: 'JetBrains Mono', 'Courier New', Courier, monospace;

    /* Theme: White (Default) */
    --bg-main: #ffffff;
    --bg-toolbar: #f3f3f3;
    --bg-tab-bar: #e5e5e5;
    --bg-tab: #d1d1d1;
    --bg-tab-active: #ffffff;
    --text-main: #333333;
    --text-muted: #666666;
    --border-color: #cccccc;
    --accent: #0078d4;
    --btn-hover: #e0e0e0;
}

[data-theme="dark"] {
    --bg-main: #1e1e1e;
    --bg-toolbar: #333333;
    --bg-tab-bar: #252526;
    --bg-tab: #2d2d2d;
    --bg-tab-active: #1e1e1e;
    --text-main: #cccccc;
    --text-muted: #999999;
    --border-color: #444444;
    --accent: #007fd4;
    --btn-hover: #4d4d4d;
}

[data-theme="monokai"] {
    --bg-main: #272822;
    /* Monokai base */
    --bg-toolbar: #1e1f1c;
    --bg-tab-bar: #171814;
    --bg-tab: #34352f;
    --bg-tab-active: #272822;
    --text-main: #f8f8f2;
    --text-muted: #8f908a;
    --border-color: #49483e;
    --accent: #a6e22e;
    --btn-hover: #49483e;
}

[data-theme="solarized-light"] {
    --bg-main: #fdf6e3;
    --bg-toolbar: #eee8d5;
    --bg-tab-bar: #e2dcc5;
    --bg-tab: #d4cfb9;
    --bg-tab-active: #fdf6e3;
    --text-main: #657b83;
    --text-muted: #93a1a1;
    --border-color: #ccc4b0;
    --accent: #268bd2;
    --btn-hover: #dfd8c4;
}

[data-theme="solarized-dark"] {
    --bg-main: #002b36;
    --bg-toolbar: #073642;
    --bg-tab-bar: #001f27;
    --bg-tab: #052c36;
    --bg-tab-active: #002b36;
    --text-main: #839496;
    --text-muted: #586e75;
    --border-color: #073642;
    --accent: #2aa198;
    --btn-hover: #0b4554;
}

/* Global Reset */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html,
body {
    height: 100%;
    width: 100%;
    overflow: hidden;
    font-family: var(--font-ui);
    background-color: var(--bg-main);
    color: var(--text-main);
    transition: background-color 0.2s, color 0.2s;
}

.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

/* Zen Mode Additions */
body.zen-mode .toolbar,
body.zen-mode .tab-bar,
body.zen-mode .status-bar {
    display: none !important;
}

body.zen-mode .content-area {
    padding: 20px 10%;
    background-color: var(--bg-main);
}

/* Toolbar */
.toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 48px;
    background-color: var(--bg-toolbar);
    border-bottom: 1px solid var(--border-color);
    padding: 0 16px;
    flex-shrink: 0;
    overflow-x: auto;
    scrollbar-width: none;
}

.toolbar::-webkit-scrollbar {
    display: none;
}

.toolbar-brand {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 16px;
    color: var(--text-main);
    margin-right: 12px;
}

.toolbar-brand i {
    font-size: 20px;
    color: var(--accent);
}

.toolbar-actions {
    display: flex;
    align-items: center;
    gap: 6px;
}

.btn-group {
    display: flex;
    align-items: center;
    gap: 4px;
}

.toolbar button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    background: transparent;
    border: none;
    color: var(--text-main);
    width: 32px;
    height: 32px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 18px;
    transition: background 0.1s;
}

.toolbar button:hover {
    background-color: var(--btn-hover);
}

.toolbar button.active {
    background-color: var(--accent);
    color: #fff;
}

.toolbar button.toggle-btn {
    width: auto;
    padding: 0 12px;
    font-family: var(--font-ui);
    font-size: 13px;
    font-weight: 500;
}

.divider {
    width: 1px;
    height: 24px;
    background-color: var(--border-color);
    margin: 0 4px;
}

/* ==========================================
 * [v2.4.0] Feature: Word Wrap ìŠ¬ë¼ì´ë”© í† ê¸€ ìŠ¤ìœ„ì¹˜
 * iOS/Android ìŠ¤íƒ€ì¼ì˜ ì¢Œìš° ìŠ¬ë¼ì´ë“œ ì „í™˜ ìŠ¤ìœ„ì¹˜
 * ========================================== */

/* í† ê¸€ ìŠ¤ìœ„ì¹˜ ì»¨í…Œì´ë„ˆ: ë ˆì´ë¸”ê³¼ ìŠ¤ìœ„ì¹˜ë¥¼ ìˆ˜í‰ ë°°ì¹˜ */
.wrap-toggle-container {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
}

/* í† ê¸€ ë ˆì´ë¸” í…ìŠ¤íŠ¸ */
.wrap-toggle-label {
    font-family: var(--font-ui);
    font-size: 12px;
    font-weight: 500;
    color: var(--text-muted);
    user-select: none;
    transition: color 0.2s;
}

/* í† ê¸€ í™œì„± ì‹œ ë ˆì´ë¸” ê°•ì¡° */
.wrap-toggle-container:has(input:checked) .wrap-toggle-label {
    color: var(--accent);
}

/* í† ê¸€ ìŠ¤ìœ„ì¹˜ ë³¸ì²´ (íŠ¸ë™) */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 36px;
    height: 20px;
    cursor: pointer;
    flex-shrink: 0;
}

/* ì‹¤ì œ ì²´í¬ë°•ìŠ¤ëŠ” ìˆ¨ê¹€ */
.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

/* ìŠ¬ë¼ì´ë” íŠ¸ë™ (OFF ìƒíƒœ) */
.toggle-slider {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--border-color);
    border-radius: 20px;
    transition: background-color 0.25s ease;
}

/* ìŠ¬ë¼ì´ë” ì›í˜• í•€ (OFF ìœ„ì¹˜: ì¢Œì¸¡) */
.toggle-slider::before {
    content: '';
    position: absolute;
    height: 14px;
    width: 14px;
    left: 3px;
    bottom: 3px;
    background-color: #ffffff;
    border-radius: 50%;
    transition: transform 0.25s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

/* ON ìƒíƒœ: íŠ¸ë™ ìƒ‰ìƒì„ accent ì»¬ëŸ¬ë¡œ ë³€í™˜ */
.toggle-switch input:checked+.toggle-slider {
    background-color: var(--accent);
}

/* ON ìƒíƒœ: í•€ì„ ìš°ì¸¡ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œ (36px - 14px - 3px*2 = 16px) */
.toggle-switch input:checked+.toggle-slider::before {
    transform: translateX(16px);
}

/* í˜¸ë²„ ì‹œ ì‹œê°ì  í”¼ë“œë°± */
.toggle-switch:hover .toggle-slider {
    background-color: var(--text-muted);
}

.toggle-switch:hover input:checked+.toggle-slider {
    filter: brightness(1.15);
}

/* [v2.6.0] select ë“œë¡­ë‹¤ìš´ ëª…ë„ ëŒ€ë¹„ ìˆ˜ì •
   ì´ì „: background: transparent â†’ ë‹¤í¬ í…Œë§ˆì—ì„œ í•˜ì–€ ë°°ê²½ì— ë°ì€ ê¸€ìê°€ ê²¹ì³ ë³´ì´ì§€ ì•ŠìŒ
   ìˆ˜ì •: íˆ´ë°” ë°°ê²½ìƒ‰ ëª…ì‹œ ì ìš© + option íƒœê·¸ì—ë„ í…Œë§ˆ ë³€ìˆ˜ ê°•ì œ ì£¼ì… */
.theme-selector select {
    background-color: var(--bg-toolbar);
    color: var(--text-main);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 4px 8px;
    font-family: var(--font-ui);
    font-size: 13px;
    outline: none;
    cursor: pointer;
}

.theme-selector select option {
    background-color: var(--bg-main);
    color: var(--text-main);
}

/* Tab Bar */
.tab-bar {
    display: flex;
    align-items: flex-end;
    height: 40px;
    background-color: var(--bg-tab-bar);
    border-bottom: 1px solid var(--border-color);
    padding: 0 8px;
    flex-shrink: 0;
}

.tabs {
    display: flex;
    height: 100%;
    overflow-x: auto;
    overflow-y: hidden;
    scrollbar-width: none;
}

.tabs::-webkit-scrollbar {
    display: none;
}

.tab {
    display: flex;
    align-items: center;
    gap: 8px;
    height: 34px;
    margin-top: 6px;
    padding: 0 12px 0 16px;
    background-color: var(--bg-tab);
    color: var(--text-muted);
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    border: 1px solid transparent;
    border-bottom: none;
    cursor: pointer;
    min-width: 120px;
    max-width: 200px;
    user-select: none;
    font-size: 13px;
    transition: opacity 0.15s, border-color 0.15s;
}

/* [v2.6.0] íƒ­ ë“œë˜ê·¸&ë“œë¡­ ì‹œê°ì  í”¼ë“œë°± */
.tab.dragging {
    opacity: 0.4;
}

.tab.drag-over {
    border-left: 2px solid var(--accent);
}

.tab:hover {
    background-color: var(--btn-hover);
}

.tab.active {
    background-color: var(--bg-tab-active);
    color: var(--text-main);
    border-color: var(--border-color);
    position: relative;
}

.tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 1px;
    background-color: var(--bg-tab-active);
}

.tab-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-grow: 1;
}

.tab-title.modified::after {
    content: " *";
    color: var(--accent);
}

.tab-title.readonly::before {
    content: "ğŸ”’ ";
    font-size: 11px;
}

.tab-close {
    border: none;
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 14px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.tab-close:hover {
    background-color: rgba(255, 0, 0, 0.1);
    color: #ff4444;
}

.add-tab {
    background: transparent;
    border: none;
    color: var(--text-muted);
    width: 28px;
    height: 28px;
    margin: 6px 4px;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.add-tab:hover {
    background-color: var(--btn-hover);
    color: var(--text-main);
}

/* Editor & Preview Workspace */
.content-area {
    display: flex;
    flex-grow: 1;
    overflow: hidden;
    position: relative;
}

.editor-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
    /* fixes flex shrink child rendering bug */
}

/* CodeMirror 6 Overrides */
.cm-editor {
    flex: 1;
    width: 100%;
    height: 100%;
    font-family: var(--font-mono) !important;
    font-size: 14px;
    line-height: 1.6;
    background: transparent !important;
    color: var(--text-main) !important;
}

.cm-editor.cm-focused {
    outline: none !important;
}

.cm-scroller {
    font-family: var(--font-mono) !important;
    overflow: auto;
    padding-top: 10px;
}

.cm-gutters {
    background-color: var(--bg-toolbar) !important;
    border-right: 1px solid var(--border-color) !important;
    color: var(--text-muted) !important;
}

.cm-activeLineGutter {
    background-color: var(--bg-tab) !important;
}

.cm-cursor,
.cm-dropCursor {
    border-left-color: var(--accent) !important;
}

.cm-selectionBackground,
.cm-editor.cm-focused .cm-selectionBackground {
    background: rgba(0, 120, 212, 0.45) !important;
}

.cm-activeLine {
    background-color: rgba(0, 0, 0, 0.05) !important;
}

[data-theme="dark"] .cm-activeLine,
[data-theme="monokai"] .cm-activeLine,
[data-theme="solarized-dark"] .cm-activeLine {
    background-color: rgba(255, 255, 255, 0.05) !important;
}

/* ==========================================
 * [v2.3.0] Feature: Minimap (Scroll Miniview)
 * @replit/codemirror-minimap ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼
 * VS Code ìŠ¤íƒ€ì¼ì˜ ìš°ì¸¡ ì¶•ì†Œ ì½”ë“œ ë¯¸ë‹ˆë·°
 * ========================================== */

/* ë¯¸ë‹ˆë§µ ì»¨í…Œì´ë„ˆ: ì—ë””í„° ìš°ì¸¡ì— ê³ ì • ë°°ì¹˜ */
.cm-minimap {
    background-color: var(--bg-toolbar) !important;
    border-left: 1px solid var(--border-color) !important;
    opacity: 0.85;
    transition: opacity 0.2s ease;
}

/* ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ ë¯¸ë‹ˆë§µ ì„ ëª…ë„ í–¥ìƒ */
.cm-minimap:hover {
    opacity: 1;
}

/* ë·°í¬íŠ¸ ì˜¤ë²„ë ˆì´: í˜„ì¬ ë³´ì´ëŠ” ì˜ì—­ì„ ë°˜íˆ¬ëª… ì‚¬ê°í˜•ìœ¼ë¡œ í‘œì‹œ */
.cm-minimap-overlay {
    background-color: rgba(0, 120, 212, 0.15) !important;
    border: 1px solid rgba(0, 120, 212, 0.3) !important;
    border-radius: 2px;
    transition: background-color 0.15s ease;
}

/* ì˜¤ë²„ë ˆì´ í˜¸ë²„ ì‹œ ë” ì§„í•œ ê°•ì¡° */
.cm-minimap-overlay:hover {
    background-color: rgba(0, 120, 212, 0.25) !important;
}

/* ë‹¤í¬ í…Œë§ˆ ê³„ì—´ ë¯¸ë‹ˆë§µ ì˜¤ë²„ë ˆì´ ìƒ‰ìƒ ì¡°ì • */
[data-theme="dark"] .cm-minimap-overlay,
[data-theme="monokai"] .cm-minimap-overlay,
[data-theme="solarized-dark"] .cm-minimap-overlay {
    background-color: rgba(100, 180, 255, 0.12) !important;
    border-color: rgba(100, 180, 255, 0.25) !important;
}

[data-theme="dark"] .cm-minimap-overlay:hover,
[data-theme="monokai"] .cm-minimap-overlay:hover,
[data-theme="solarized-dark"] .cm-minimap-overlay:hover {
    background-color: rgba(100, 180, 255, 0.22) !important;
}

/* Monokai í…Œë§ˆ ë¯¸ë‹ˆë§µ íŠ¹ìˆ˜ ê°•ì¡° (í˜•ê´‘ ê·¸ë¦° í¬ì¸íŠ¸) */
[data-theme="monokai"] .cm-minimap-overlay {
    border-color: rgba(166, 226, 46, 0.3) !important;
}

/* Print Rules */
/* [4ì°¨ ê°ì‚¬ 1] ë‹¤ì¤‘ í˜ì´ì§€ ì¸ì‡„ ì§€ì›: ìµœìƒìœ„ ì»¨í…Œì´ë„ˆ ë†’ì´ ì œí•œ í•´ì œ */
@media print {

    /* SPA ì›¹ì•±ì˜ ì „í˜•ì  ì¸ì‡„ ë²„ê·¸ ìˆ˜ì •:
       height: 100%ì™€ overflow: hiddenì´ ê±¸ë¦° ë˜í¼ë“¤ì´
       í”„ë¦°íŠ¸ ìŠ¤í’€ëŸ¬ì—ì„œ 1í˜ì´ì§€ë¡œ ê°•ì œ í¬ë¡­ë˜ëŠ” ë¬¸ì œ í•´ê²° */
    html,
    body,
    .app-container,
    .content-area {
        height: auto !important;
        overflow: visible !important;
    }

    .toolbar,
    .tab-bar,
    .status-bar,
    .editor-wrapper {
        display: none !important;
    }

    .markdown-preview {
        display: block !important;
        width: 100% !important;
        border: none !important;
        overflow: visible !important;
        background: #fff !important;
        color: #000 !important;
    }
}

/* Markdown Styles inside Preview */
.markdown-preview {
    flex: 1;
    width: 50%;
    height: 100%;
    overflow-y: auto;
    padding: 16px 32px;
    border-left: 1px solid var(--border-color);
    background-color: var(--bg-main);
    color: var(--text-main);
    font-family: var(--font-ui);
    line-height: 1.6;
}

.markdown-preview.hidden {
    display: none;
}

.markdown-preview h1,
.markdown-preview h2,
.markdown-preview h3,
.markdown-preview h4,
.markdown-preview h5,
.markdown-preview h6 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
}

.markdown-preview h1 {
    font-size: 2em;
    padding-bottom: 0.3em;
    border-bottom: 1px solid var(--border-color);
}

.markdown-preview h2 {
    font-size: 1.5em;
    padding-bottom: 0.3em;
    border-bottom: 1px solid var(--border-color);
}

.markdown-preview p {
    margin-bottom: 16px;
}

.markdown-preview code {
    padding: 0.2em 0.4em;
    font-size: 85%;
    background-color: var(--bg-toolbar);
    border-radius: 6px;
    font-family: var(--font-mono);
}

.markdown-preview pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: var(--bg-toolbar);
    border-radius: 6px;
    margin-bottom: 16px;
}

.markdown-preview pre code {
    background-color: transparent;
    padding: 0;
}

.markdown-preview blockquote {
    padding: 0 1em;
    color: var(--text-muted);
    border-left: 0.25em solid var(--border-color);
    margin-bottom: 16px;
}

/* Status Bar */
.status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 24px;
    background-color: var(--accent);
    color: #ffffff;
    padding: 0 16px;
    font-size: 12px;
    flex-shrink: 0;
}

.status-bar .status-right {
    display: flex;
    gap: 16px;
}

/* ==========================================
 * Feature: Custom Search Modal (Floating API)
 * ========================================== */
.search-modal {
    position: absolute;
    top: 10px;
    right: 20px;
    width: 320px;
    background-color: var(--bg-main);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    font-family: var(--font-ui);
    overflow: hidden;
    transition: opacity 0.2s, transform 0.2s;
}

.search-modal.hidden {
    opacity: 0;
    pointer-events: none;
    transform: translateY(-10px);
}

.search-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 12px;
    background-color: var(--bg-toolbar);
    border-bottom: 1px solid var(--border-color);
    font-size: 13px;
    font-weight: 600;
    color: var(--text-main);
}

.search-header .icon-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    border-radius: 4px;
    padding: 2px;
}

.search-header .icon-btn:hover {
    background-color: var(--btn-hover);
    color: var(--accent);
}

.search-body {
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.search-row {
    display: flex;
    gap: 6px;
    align-items: center;
}

.search-row input[type="text"] {
    flex-grow: 1;
    background-color: var(--bg-main);
    border: 1px solid var(--border-color);
    color: var(--text-main);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 13px;
    outline: none;
}

.search-row input[type="text"]:focus {
    border-color: var(--accent);
}

.search-row .icon-btn,
.search-row button {
    background-color: var(--bg-toolbar);
    border: 1px solid var(--border-color);
    color: var(--text-main);
    cursor: pointer;
    border-radius: 4px;
    padding: 4px 6px;
    font-size: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 28px;
}

.search-row button:hover,
.search-row .icon-btn:hover {
    background-color: var(--btn-hover);
    color: var(--accent);
    border-color: var(--accent);
}

.search-info {
    font-size: 12px;
    color: var(--text-muted);
    text-align: right;
    min-height: 14px;
}

/* ==========================================
 * Feature: Mobile Responsive Layout Updates
 * ========================================== */
@media (max-width: 768px) {

    /* Make toolbar scrollable and compact */
    .toolbar {
        padding: 0 8px;
        height: 44px;
    }

    .toolbar button {
        width: 36px;
        /* Slightly larger targets for touch */
        height: 36px;
    }

    /* Make tab bar more compact */
    .tab-bar {
        padding: 0 4px;
        height: 36px;
    }

    .tab {
        height: 30px;
        margin-top: 6px;
        min-width: 90px;
        padding: 0 8px;
        font-size: 12px;
    }

    .tab-close {
        width: 18px;
        height: 18px;
    }

    /* Floating search modal responsive */
    .search-modal {
        width: 90%;
        left: 5%;
        right: 5%;
        top: 8px;
    }

    /* Make status bar font smaller */
    .status-bar {
        padding: 0 8px;
        font-size: 10px;
    }

    .status-bar .status-right {
        gap: 8px;
    }
}